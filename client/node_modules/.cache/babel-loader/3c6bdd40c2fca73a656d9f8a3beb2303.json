{"ast":null,"code":"import { useCallback, useEffect, useRef } from 'react';\nimport { logChatPromiseExecution } from 'stream-chat';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nexport var useMessageInputText = function (props, state, dispatch) {\n  var channel = useChannelStateContext('useMessageInputText').channel;\n  var additionalTextareaProps = props.additionalTextareaProps,\n      focus = props.focus,\n      parent = props.parent,\n      _a = props.publishTypingEvent,\n      publishTypingEvent = _a === void 0 ? true : _a;\n  var text = state.text;\n  var textareaRef = useRef(); // Focus\n\n  useEffect(function () {\n    if (focus && textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  }, [focus]); // Text + cursor position\n\n  var newCursorPosition = useRef();\n  var insertText = useCallback(function (textToInsert) {\n    var maxLength = (additionalTextareaProps || {}).maxLength;\n\n    if (!textareaRef.current) {\n      dispatch({\n        getNewText: function (text) {\n          var updatedText = text + textToInsert;\n\n          if (maxLength && updatedText.length > maxLength) {\n            return updatedText.slice(0, maxLength);\n          }\n\n          return updatedText;\n        },\n        type: 'setText'\n      });\n      return;\n    }\n\n    var _a = textareaRef.current,\n        selectionEnd = _a.selectionEnd,\n        selectionStart = _a.selectionStart;\n    newCursorPosition.current = selectionStart + textToInsert.length;\n    dispatch({\n      getNewText: function (prevText) {\n        var updatedText = prevText.slice(0, selectionStart) + textToInsert + prevText.slice(selectionEnd);\n\n        if (maxLength && updatedText.length > maxLength) {\n          return updatedText.slice(0, maxLength);\n        }\n\n        return updatedText;\n      },\n      type: 'setText'\n    });\n  }, [additionalTextareaProps, newCursorPosition, textareaRef]);\n  useEffect(function () {\n    var textareaElement = textareaRef.current;\n\n    if (textareaElement && newCursorPosition.current !== undefined) {\n      textareaElement.selectionStart = newCursorPosition.current;\n      textareaElement.selectionEnd = newCursorPosition.current;\n      newCursorPosition.current = undefined;\n    }\n  }, [text, newCursorPosition]);\n  var handleChange = useCallback(function (event) {\n    event.preventDefault();\n\n    if (!event || !event.target) {\n      return;\n    }\n\n    var newText = event.target.value;\n    dispatch({\n      getNewText: function () {\n        return newText;\n      },\n      type: 'setText'\n    });\n\n    if (publishTypingEvent && newText && channel) {\n      logChatPromiseExecution(channel.keystroke(parent === null || parent === void 0 ? void 0 : parent.id), 'start typing event');\n    }\n  }, [channel, parent, publishTypingEvent]);\n  return {\n    handleChange: handleChange,\n    insertText: insertText,\n    textareaRef: textareaRef\n  };\n};","map":{"version":3,"names":["useCallback","useEffect","useRef","logChatPromiseExecution","useChannelStateContext","useMessageInputText","props","state","dispatch","channel","additionalTextareaProps","focus","parent","_a","publishTypingEvent","text","textareaRef","current","newCursorPosition","insertText","textToInsert","maxLength","getNewText","updatedText","length","slice","type","selectionEnd","selectionStart","prevText","textareaElement","undefined","handleChange","event","preventDefault","target","newText","value","keystroke","id"],"sources":["/Users/cherrie/Desktop/messenger_ver_2/node_modules/stream-chat-react/dist/components/MessageInput/hooks/useMessageInputText.js"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport { logChatPromiseExecution } from 'stream-chat';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nexport var useMessageInputText = function (props, state, dispatch) {\n    var channel = useChannelStateContext('useMessageInputText').channel;\n    var additionalTextareaProps = props.additionalTextareaProps, focus = props.focus, parent = props.parent, _a = props.publishTypingEvent, publishTypingEvent = _a === void 0 ? true : _a;\n    var text = state.text;\n    var textareaRef = useRef();\n    // Focus\n    useEffect(function () {\n        if (focus && textareaRef.current) {\n            textareaRef.current.focus();\n        }\n    }, [focus]);\n    // Text + cursor position\n    var newCursorPosition = useRef();\n    var insertText = useCallback(function (textToInsert) {\n        var maxLength = (additionalTextareaProps || {}).maxLength;\n        if (!textareaRef.current) {\n            dispatch({\n                getNewText: function (text) {\n                    var updatedText = text + textToInsert;\n                    if (maxLength && updatedText.length > maxLength) {\n                        return updatedText.slice(0, maxLength);\n                    }\n                    return updatedText;\n                },\n                type: 'setText',\n            });\n            return;\n        }\n        var _a = textareaRef.current, selectionEnd = _a.selectionEnd, selectionStart = _a.selectionStart;\n        newCursorPosition.current = selectionStart + textToInsert.length;\n        dispatch({\n            getNewText: function (prevText) {\n                var updatedText = prevText.slice(0, selectionStart) + textToInsert + prevText.slice(selectionEnd);\n                if (maxLength && updatedText.length > maxLength) {\n                    return updatedText.slice(0, maxLength);\n                }\n                return updatedText;\n            },\n            type: 'setText',\n        });\n    }, [additionalTextareaProps, newCursorPosition, textareaRef]);\n    useEffect(function () {\n        var textareaElement = textareaRef.current;\n        if (textareaElement && newCursorPosition.current !== undefined) {\n            textareaElement.selectionStart = newCursorPosition.current;\n            textareaElement.selectionEnd = newCursorPosition.current;\n            newCursorPosition.current = undefined;\n        }\n    }, [text, newCursorPosition]);\n    var handleChange = useCallback(function (event) {\n        event.preventDefault();\n        if (!event || !event.target) {\n            return;\n        }\n        var newText = event.target.value;\n        dispatch({\n            getNewText: function () { return newText; },\n            type: 'setText',\n        });\n        if (publishTypingEvent && newText && channel) {\n            logChatPromiseExecution(channel.keystroke(parent === null || parent === void 0 ? void 0 : parent.id), 'start typing event');\n        }\n    }, [channel, parent, publishTypingEvent]);\n    return {\n        handleChange: handleChange,\n        insertText: insertText,\n        textareaRef: textareaRef,\n    };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}